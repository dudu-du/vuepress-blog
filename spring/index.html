<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Springå­¦ä¹ ç¬”è®° | è¿½æ±‚å“è¶Šï¼ŒæˆåŠŸä¼šåœ¨ä¸ç»æ„é—´è¿½ä¸Šä½ </title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/docs/favicon.ico">
    <meta name="description" content="è¿½æ±‚å“è¶Šï¼ŒæˆåŠŸä¼šåœ¨ä¸ç»æ„é—´è¿½ä¸Šä½ ">
    
    <link rel="preload" href="/docs/assets/css/0.styles.ab7a6878.css" as="style"><link rel="preload" href="/docs/assets/js/app.5a0d12c5.js" as="script"><link rel="preload" href="/docs/assets/js/2.e7fbde6b.js" as="script"><link rel="preload" href="/docs/assets/js/9.499b8aef.js" as="script"><link rel="prefetch" href="/docs/assets/js/3.1d2bffe0.js"><link rel="prefetch" href="/docs/assets/js/4.e58f9b9b.js"><link rel="prefetch" href="/docs/assets/js/5.41fed955.js"><link rel="prefetch" href="/docs/assets/js/6.6748e3a0.js"><link rel="prefetch" href="/docs/assets/js/7.efe41c78.js"><link rel="prefetch" href="/docs/assets/js/8.28fe212e.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.ab7a6878.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">è¿½æ±‚å“è¶Šï¼ŒæˆåŠŸä¼šåœ¨ä¸ç»æ„é—´è¿½ä¸Šä½ </span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/docs/spring/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Spring
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/docs/language/japanese/" class="nav-link">
  Japanese
</a></li><li class="dropdown-item"><h4>
          Group1
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-subitem"><a href="/docs/language/japanese/" class="nav-link">
  Japanese
</a></li></ul></li><li class="dropdown-item"><h4>
          Group2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-subitem"><a href="/docs/language/japanese/" class="nav-link">
  Japanese
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/docs/spring/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Spring
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Language Menu" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Language Menu" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-item"><!----> <a href="/docs/language/japanese/" class="nav-link">
  Japanese
</a></li><li class="dropdown-item"><h4>
          Group1
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-subitem"><a href="/docs/language/japanese/" class="nav-link">
  Japanese
</a></li></ul></li><li class="dropdown-item"><h4>
          Group2
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/language/chinese/" class="nav-link">
  Chinese
</a></li><li class="dropdown-subitem"><a href="/docs/language/japanese/" class="nav-link">
  Japanese
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  External
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Springå­¦ä¹ ç¬”è®°</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/spring/#_1-iocå®¹å™¨æºç è§£æ" class="sidebar-link">1. IOCå®¹å™¨æºç è§£æ</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/spring/#_1-1-beandefinition" class="sidebar-link">1.1 BeanDefinition</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-2-beanfactoryã€ç®€å•å®¹å™¨ã€‘" class="sidebar-link">1.2 BeanFactoryã€ç®€å•å®¹å™¨ã€‘</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-3-applicationcontextã€é«˜çº§å®¹å™¨ã€‘" class="sidebar-link">1.3 ApplicationContextã€é«˜çº§å®¹å™¨ã€‘</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-4-resourceã€resourceloader" class="sidebar-link">1.4. Resourceã€ResourceLoader</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-5-beandefinitionreader" class="sidebar-link">1.5 BeanDefinitionReader</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-6-beandefinitionregistry" class="sidebar-link">1.6 BeanDefinitionRegistry</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-7-beandefinitionæ³¨å†Œæµç¨‹" class="sidebar-link">1.7 BeanDefinitionæ³¨å†Œæµç¨‹</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-8-xmlé…ç½®æ–‡ä»¶åŠ è½½beandefinitionæµç¨‹" class="sidebar-link">1.8 xmlé…ç½®æ–‡ä»¶åŠ è½½BeanDefinitionæµç¨‹</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_1-9-æ³¨è§£é…ç½®åŠ è½½beandefinitionæµç¨‹" class="sidebar-link">1.9 æ³¨è§£é…ç½®åŠ è½½BeanDefinitionæµç¨‹</a></li></ul></li><li><a href="/docs/spring/#_2-refresh-æ–¹æ³•" class="sidebar-link">2. Refresh()æ–¹æ³•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/spring/#_2-1-postprocessor" class="sidebar-link">2.1 PostProcessor</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_2-2-awareæ¥å£" class="sidebar-link">2.2 Awareæ¥å£</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_2-3-äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼" class="sidebar-link">2.3 äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/docs/spring/#_2-4-refresh-æ–¹æ³•æµç¨‹" class="sidebar-link">2.4 refresh()æ–¹æ³•æµç¨‹</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="_1-iocå®¹å™¨æºç è§£æ"><a href="#_1-iocå®¹å™¨æºç è§£æ" class="header-anchor">#</a> 1. IOCå®¹å™¨æºç è§£æ</h2> <p><img src="/assets/img/spring/image-20220425080658717.png" alt="image-20220425080658717"></p> <h3 id="_1-1-beandefinition"><a href="#_1-1-beandefinition" class="header-anchor">#</a> 1.1 BeanDefinition</h3> <blockquote><p>https://cloud.tencent.com/developer/article/1497805</p></blockquote> <ul><li><p>Beanæ˜¯Springçš„ä¸€ç­‰å…¬æ°‘</p></li> <li><p>å¯ä»¥æŠŠBeanDefinitionç±»æ¯”ä¸ºJavaä¸­çš„Classï¼ŒJavaä¸­ç”¨Classæè¿°Javaç±»å¹¶åˆ¶ä½œå¯¹è±¡å®ä¾‹ï¼Œè€Œåœ¨Springä¸­ï¼Œé€šè¿‡BeanDefinitionæ¥æè¿°å¹¶åˆ¶ä½œBean</p></li> <li><p>åœ¨BeanDefinitionä¸­ï¼ŒåŒ…å«äº†æœ‰åˆ«äºJavaå¯¹è±¡çš„é¢å¤–å±æ€§ï¼Œå¦‚ä¸‹ğŸ‘‡</p></li></ul> <table><thead><tr><th style="text-align:center;">é¢å¤–å±æ€§</th> <th style="text-align:center;">XMLæ–¹å¼</th> <th style="text-align:center;">æ³¨è§£æ–¹å¼</th> <th style="text-align:center;">æè¿°</th></tr></thead> <tbody><tr><td style="text-align:center;">ä½œç”¨èŒƒå›´</td> <td style="text-align:center;">scope</td> <td style="text-align:center;">@Scope</td> <td style="text-align:center;">singletonã€prototypeã€requestã€sessionã€globalsession</td></tr> <tr><td style="text-align:center;">æ‡’åŠ è½½</td> <td style="text-align:center;">lazy-init</td> <td style="text-align:center;">@Lazy</td> <td style="text-align:center;">ç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šåˆ›å»ºå‡ºbeançš„å®ä¾‹</td></tr> <tr><td style="text-align:center;">é¦–é€‰</td> <td style="text-align:center;">primary</td> <td style="text-align:center;">@Primary</td> <td style="text-align:center;">è®¾ç½®ä¸ºtrueçš„beanä¼šæ˜¯ä¼˜å…ˆçš„å®ç°ç±»</td></tr> <tr><td style="text-align:center;">å·¥å‚Bean<br>å·¥å‚æ–¹æ³•</td> <td style="text-align:center;">factory-bean<br>factory-method</td> <td style="text-align:center;">@Configuration<br>@Bean</td> <td style="text-align:center;">å¦‚ä¸‹å›¾ï¼Œ</td></tr></tbody></table> <p><img src="/assets/img/spring/image-20220425075431872.png" alt="image-20220425075431872"></p> <img src="/assets/img/spring/image-20220425080738344.png" alt="image-20220425080738344" style="zoom:40%;"> <ul><li><p><code>AttributeAccessor</code></p> <ul><li>å®šä¹‰äº†æœ€åŸºæœ¬çš„å¯¹ä»»æ„å¯¹è±¡å…ƒæ•°æ®çš„ä¿®æ”¹æˆ–è€…è·å–æ–¹å¼</li> <li>BeanDefinitionç»§æ‰¿äº†ä»–ï¼Œç”¨äºè·å–BeanDefinitionçš„å±æ€§ï¼Œå¹¶å¯¹è¿™äº›å±æ€§è¿›è¡Œæ“ä½œ</li></ul></li> <li><p><code>BeamMetadataElement</code></p> <ul><li>æä¾›äº†ä¸€ä¸ª<code>getResource()</code>æ–¹æ³•</li> <li>ç”¨æ¥ä¼ è¾“ä¸€ä¸ªå¯ä»¥é…ç½®çš„æºå¯¹è±¡ï¼Œå¯¹äºBeanDefinitionæ¥è¯´ï¼Œç”¨æ¥è¿”å›å®ƒçš„Classå¯¹è±¡ï¼Ÿï¼Ÿï¼Ÿ</li></ul></li> <li><p><code>AttributeAccessorSupport</code></p> <ul><li>AttributeAccessorçš„ç®€å•å®ç°</li> <li>å®šä¹‰äº†ä¸€ä¸ªLinkedHashMapï¼Œç”¨äºå­˜å‚¨æŸä¸ªå¯¹è±¡çš„å…ƒæ•°æ®</li></ul></li> <li><p><code>AbstractBeanDefinition</code></p> <blockquote><p>ç»éªŒï¼šåœ¨ç¼–å†™ä»£ç è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ¶‰åŠåˆ°å¤šä¸ªå®ç°å­ç±»ï¼Œå¹¶ä¸”å¤šä¸ªå®ç°å­ç±»ä¹‹é—´æœ‰è®¸å¤šé€šç”¨éƒ¨åˆ†ï¼Œå¯ä»¥å°†è¿™äº›é€šç”¨éƒ¨åˆ†æ”¾åˆ°ä¸€ä¸ªæŠ½è±¡ç±»ä¸­</p></blockquote> <ul><li>BeanDefinitionå®ç°ç±»çš„åŸºç±»</li> <li>å®šä¹‰äº†ä¸€ä¸ªé€šç”¨çš„æ„é€ å‡½æ•°<code>AbstractBeanDefinition(BeanDefinition original)</code>ï¼Œä¸ºæŒ‡å®šçš„BeanDefinitionåšæ·±åº¦æ‹·è´ã€å®šä¹‰äº†ä¸€äº›é€šç”¨çš„å±æ€§å’Œgetterã€setteræ–¹æ³•ï¼Œæ–¹ä¾¿èµ‹å€¼ã€‘ï¼ŒfactoryBeanå’ŒfactoryMethodä¹Ÿåœ¨è¿™é‡Œè®¾ç½®</li> <li>å…¬å…±çš„å·¥å…·æ–¹æ³•
<ul><li><code>overrideFrom(BeanDefinition other)</code>ï¼šç”¨åˆ«çš„BeanDefinitionçš„å±æ€§å…¨é‡è¦†ç›–å½“å‰BeanDefinition</li> <li><code>applyDefaults(BeanDefinitionDefaults defaults)</code>ï¼šä¸ºå½“å‰BeanDefinitionè®¾ç½®åˆå§‹å€¼</li></ul></li></ul></li> <li><p><code>RootBeanDefinition</code></p> <ul><li>BeanDefinitionä¹‹é—´çš„ç»§æ‰¿å…³ç³»æ˜¯é€šè¿‡è®¾ç½®pairentNameå±æ€§æ¥å†³å®šçš„</li> <li>å¯ä»¥å•ç‹¬ä½œä¸ºBeanDefinitionï¼Œä¹Ÿå¯ä»¥ä½œä¸ºå…¶ä»–BeanDefinitionçš„çˆ¶ç±»ï¼Œä½†æ˜¯ä¸èƒ½ä½œä¸ºå…¶ä»–BeanDefinitionçš„å­ç±»ï¼Œå¦‚æœä¸ºä»–è®¾ç½®parentNameï¼Œä¼šæŠ›å‡ºå¼‚å¸¸</li> <li>RootBeanDefinitionç”¨æ¥åœ¨è¿è¡Œæ—¶æ¥æ”¶å¤šä¸ªBeanDefinitionåˆå¹¶èµ·æ¥çš„ä¿¡æ¯</li> <li>é…ç½®æ–‡ä»¶é‡Œçš„Beanæ ‡ç­¾ä¼šè¢«è§£ææˆRootBeanDefinitionï¼ŒSpring2.5ä¹‹åä½¿ç”¨äº†GenericBeanDefinitionå–ä»£äº†RootBeanDefinitionå’ŒChildBeanDefinition</li></ul></li> <li><p><code>ChildBeanDefinition</code></p> <ul><li>ä¸å¯ä»¥å•ç‹¬å­˜åœ¨ï¼Œå¿…é¡»ä¾èµ–ä¸€ä¸ªçˆ¶BeanDefinitionï¼Œå·²ç»å®Œå…¨è¢«GenericBeanDefinitionå–ä»£äº†</li></ul></li> <li><p><code>GenericBeanDefinition</code></p> <ul><li>Spring2.5ä¹‹åï¼Œæ–°åŠ å…¥çš„Beanæ–‡ä»¶é…ç½®å±æ€§å®šä¹‰ç±»ï¼Œæ˜¯ChildBeanDefinitionå’ŒRootBeanDefinitionæ›´å¥½çš„æ›¿ä»£æ–¹æ¡ˆ</li> <li>åœ¨AbstractBeanDefinitionåŸºç¡€ä¸Šå¢åŠ äº†parentNameå±æ€§ï¼Œå…¶ä»–åŸºæœ¬æ²¡å˜</li></ul></li></ul> <h3 id="_1-2-beanfactoryã€ç®€å•å®¹å™¨ã€‘"><a href="#_1-2-beanfactoryã€ç®€å•å®¹å™¨ã€‘" class="header-anchor">#</a> 1.2 BeanFactoryã€ç®€å•å®¹å™¨ã€‘</h3> <blockquote><p>BeanFactoryæ˜¯SpringIOCå®¹å™¨çš„æ ¹æ¥å£ï¼Œå®šä¹‰äº†beanå·¥å‚æœ€åŸºç¡€çš„åŠŸèƒ½ç‰¹æ€§</p> <p>Beanéƒ½æ˜¯ç”±å®ƒçš„å®ç°ç±»æ¥ç®¡ç†çš„</p></blockquote> <ul><li><p>ä¸»è¦æ–¹æ³•</p> <ul><li>getBean(String name)</li> <li>getBean(Class type)</li> <li>isSingleton(String name)</li> <li>isPrototype(String name)</li> <li>getType(String name)</li> <li>getAliases(String name)</li></ul></li> <li><p>åœ¨<code>BeanFactory</code>æ¥å£ä¸­å®šä¹‰äº†ä¸€ä¸ªå˜é‡</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// ç”¨æ¥è·å–FactoryBeançš„å®ä¾‹</span>
<span class="token class-name">String</span> FACTORY_BEAN_PREFIX <span class="token operator">=</span> <span class="token string">&quot;&amp;&quot;</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p><code>FactoryBean</code>æ¥å£</p> <ul><li><code>getObject()</code> - ç”¨æˆ·å¯ä»¥é€šè¿‡ä¸€å¥—å¤æ‚çš„é€»è¾‘æ¥ç”Ÿæˆbean</li> <li>æœ¬è´¨ä¹Ÿæ˜¯ä¸€ä¸ªbeanï¼Œç”¨æ¥ç”Ÿæˆæ™®é€šçš„bean</li> <li>å®¹å™¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œä¼šæŠŠå®ç°äº†è¿™ä¸ªæ¥å£çš„beanå–å‡ºæ¥ï¼Œä½¿ç”¨beané‡Œé¢çš„getObject()æ–¹æ³•æ¥ç”Ÿæˆæˆ‘ä»¬æƒ³è¦çš„bean</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserFactoryBean</span> <span class="token keyword">implements</span> <span class="token class-name">FactoryBean</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> <span class="token function">getObjectType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userFactoryBean<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.zhaoxuan.entity.factory.UserFactoryBean<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">User</span><span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token string">&quot;userFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// com.zhaoxuan.entity.User@239963d8</span>
<span class="token comment">// è¿”å›çš„æ˜¯Userå®ä¾‹</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">UserFactoryBean</span> userFactoryBean <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">UserFactoryBean</span><span class="token punctuation">)</span> context
        <span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">BeanFactory</span><span class="token punctuation">.</span>FACTORY_BEAN_PREFIX <span class="token operator">+</span> <span class="token string">&quot;userFactoryBean&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// com.zhaoxuan.entity.factory.UserFactoryBean@3abbfa04</span>
<span class="token comment">// è¿”å›çš„æ˜¯factoryBeanå®ä¾‹</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>userFactoryBean<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><img src="/assets/img/spring/image-20220425182311945.png" alt="image-20220425182311945" style="zoom:40%;"></li> <li><p>å•ä¸€èŒè´£ï¼Œæ¯ä¸ªè¾ƒé¡¶å±‚æ¥å£éƒ½æ˜¯å•ä¸€èŒè´£çš„ï¼Œåªæä¾›æŸä¸€æ–¹é¢çš„åŠŸèƒ½</p></li> <li><p><code>ListableBeanFactory</code></p> <ul><li>ä»¥åˆ—è¡¨çš„å½¢å¼æä¾›beançš„ç›¸å…³ä¿¡æ¯</li> <li>æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯æ‰¹é‡åˆ—å‡ºå·¥å‚ç”Ÿäº§çš„å®ä¾‹çš„ä¿¡æ¯ã€getBeanDefinitionNames()ã€‘</li></ul></li> <li><p><code>HierarchicalBeanFactory</code></p> <blockquote><p>å…è®¸BeanFactoryè¿›è¡Œåˆ†å±‚</p></blockquote> <ul><li>getParentBeanFactory() - å¦‚æœæœ‰çˆ¶å·¥å‚ï¼Œåˆ™è¿”å›</li> <li>containsLocalBean(String name) - æœ¬å±‚æ˜¯å¦åŒ…å«æŸä¸ªbeanï¼Œä¸ä¼šåœ¨çˆ¶å·¥å‚æŸ¥æ‰¾</li> <li>å®ç°äº†è¯¥æ¥å£çš„å®¹å™¨ï¼Œå¯ä»¥åœ¨åº”ç”¨ä¸­å¯åŠ¨å¤šä¸ªBeanFactoryï¼Œå°†å„ä¸ªBeanFactoryè®¾ç½®ä¸ºçˆ¶å­å…³ç³»ï¼Œè¿™æ ·èƒ½å¾ˆå¥½é€‚é…ä¸‰å±‚æ¶æ„äº†ï¼Œæ¯”å¦‚å®¹å™¨Aç®¡ç†Controllerå±‚çš„beanï¼Œå®¹å™¨Bç®¡ç†Serviceå±‚çš„bean......</li></ul></li> <li><p><code>AutowireCapableBeanFactory</code></p> <ul><li>ç»™å®¹å™¨èµ‹äºˆäº†è‡ªåŠ¨è£…é…beançš„èƒ½åŠ›ï¼Œæ ¹æ®BeanDefinitionå»è£…é…beanï¼Œæ‰§è¡Œå‰åå¤„ç†å™¨</li> <li>é›†æˆå…¶ä»–æ¡†æ¶çš„æ—¶å€™ï¼Œè¯¥æ¥å£çš„å®ç°ç±»ä¾‹å¦‚<code>AbstractAutowireCapableBeanFactory</code>ï¼Œé€šè¿‡ä»–çš„autowireBeanæ–¹æ³•é‡Œé¢çš„populateBeanæ–¹æ³•å»æŠŠå…¶ä»–æ¡†æ¶çš„å®ä¾‹æ³¨å†Œåˆ°IOCå®¹å™¨ä¸­</li> <li>@Autowiredçš„å¤„ç†é€»è¾‘æœ€ç»ˆè°ƒç”¨äº†<code>AutowireCapableBeanFactory</code>çš„<code>resolveDependency(DependencyDescriptor descriptor, @Nullable String requestingBeanName)</code>å®ç°çš„ä¾èµ–æ³¨å…¥</li> <li>5ç§è£…é…ç­–ç•¥
<ul><li>0 - æ²¡æœ‰è‡ªåŠ¨è£…é…</li> <li>1 - æ ¹æ®åç§°</li> <li>2 - æ ¹æ®ç±»å‹ - @Autowiredä½¿ç”¨</li> <li>3 - æ ¹æ®æ„é€ å‡½æ•°</li> <li>4 - Spring3.0åºŸå¼ƒ</li></ul></li> <li>è¿˜å®šä¹‰äº†ä¸€äº›è·Ÿè‡ªåŠ¨è£…é…ç›¸å…³çš„æ–¹æ³•ä»¥åŠæ‰§è¡ŒBeanPostProcessorçš„æ–¹æ³•</li></ul></li> <li><p><code>ConfigurableBeanFactory</code></p> <ul><li>è®¾ç½®çˆ¶å®¹å™¨ã€ç±»åŠ è½½å™¨ã€å±æ€§ç¼–è¾‘å™¨ã€å®¹å™¨é€šç”¨çš„åç½®å¤„ç†å™¨ç­‰æ–¹æ³•</li> <li>ç»§æ‰¿äº†<code>SingletonBeanRegistry</code>ï¼Œæä¾›äº†åœ¨è¿è¡ŒæœŸé—´å‘å®¹å™¨æ³¨å†Œå•ä¾‹å®ä¾‹beançš„èƒ½åŠ›</li></ul></li> <li><p><code>ConfigurableListableBeanFactory</code></p> <ul><li>æ•´åˆäº†BeanFactoryä½“ç³»çš„æ‰€æœ‰äºŒçº§æ¥å£ï¼ŒåŒ…å«äº†BeanFactoryä½“ç³»çš„æ‰€æœ‰æ–¹æ³•</li> <li>åŠ å…¥äº†è¯¸å¦‚å¿½ç•¥è‡ªåŠ¨è£…é…ç­‰10ä¸ªæ–¹æ³•</li></ul></li> <li><p><code>DefaultListableBeanFactory</code></p> <ul><li>ç¬¬ä¸€ä¸ªçœŸæ­£å¯ä»¥ç‹¬ç«‹è¿è¡Œçš„IOCå®¹å™¨</li> <li>å®ç°äº†BeanDefinitionRegistryæ¥å£</li> <li>æœ€å…³é”®çš„æˆå‘˜å˜é‡beanDefinitionMapï¼ŒSpringä¸­æœ‰ä¸¤ä¸ªåœ°æ–¹å®šä¹‰äº†beanDefinitionMapï¼Œå¦å¤–ä¸€ä¸ªæ˜¯<code>SimpleBeanDefinitionRegistry</code>ï¼Œåªæä¾›æ³¨å†Œè¡¨åŠŸèƒ½ï¼Œå¹¶æ— å·¥å‚åŠŸèƒ½</li> <li>ApplicationContextæœ€ç»ˆå®ç°å­ç±»é‡Œï¼Œç”±äºå¯¹BeanDefinitionè¿›è¡Œæ³¨å†Œæ˜¯ä¸€é¡¹å¿…é¡»å…·å¤‡çš„éœ€æ±‚ï¼Œæ‰€ä»¥ä»–ä»¬ä¼šä»¥ç»„åˆçš„æ–¹å¼å»è°ƒç”¨DefaultListableBeanFactoryæä¾›çš„registerBeanDefinitionæ–¹æ³•å¯¹BeanDefinitionè¿›è¡Œæ³¨å†Œ</li></ul></li></ul> <h3 id="_1-3-applicationcontextã€é«˜çº§å®¹å™¨ã€‘"><a href="#_1-3-applicationcontextã€é«˜çº§å®¹å™¨ã€‘" class="header-anchor">#</a> 1.3 ApplicationContextã€é«˜çº§å®¹å™¨ã€‘</h3> <img src="/assets/img/spring/image-20220425182433330.png" alt="image-20220425182433330" style="zoom:50%;"> <ul><li><p><code>ApplicationContext</code></p> <blockquote><p>EnvironmentCapableã€ListableBeanFactoryã€HierarchicalBeanFactoryã€MessageSourceã€ApplicationEventPublisherã€ResourcePatternResolver</p></blockquote></li> <li><p>ä¼ ç»ŸåŸºäºXMLé…ç½®çš„ç»å…¸å®¹å™¨</p> <ul><li><code>FileSystemXmlApplicationContext</code></li> <li><code>ClassPathXmlApplication</code></li> <li><code>XmlWebApplicationContext</code> - ç”¨äºwebåº”ç”¨ç¨‹åºçš„å®¹å™¨</li></ul></li> <li><p>ç›®å‰æ¯”è¾ƒæµè¡Œçš„</p> <ul><li><code>AnnotationConfigServletWebServerApplicationContext</code> - åœ¨springbootçš„bootæ¨¡å—ä¸‹</li> <li><code>AnnotationConfigReactiveWebServerApplicationContext</code> - åœ¨springbootçš„bootæ¨¡å—ä¸‹</li> <li><code>AnnotationConfigApplicationContext</code></li></ul></li> <li><p>ä¸Šè¿°å®¹å™¨çš„å…±åŒç‚¹ ----- refresh()æ–¹æ³•</p></li> <li><p><code>ConfigurableApplicationContext</code></p> <ul><li>ç»§æ‰¿<code>LifeCycle</code>ã€<code>Closeable</code>ç”¨äºå¯¹å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†å’Œèµ„æºçš„é‡Šæ”¾</li> <li>ä¸»è¦ä¸¤ä¸ªæ–¹æ³•refreshå’Œcloseï¼Œè®©ApplicationContextå…·å¤‡å¯åŠ¨åˆ·æ–°ã€å…³é—­åº”ç”¨ä¸Šä¸‹æ–‡çš„èƒ½åŠ›</li></ul></li> <li><p><code>AbstractApplicationContext</code></p> <ul><li>Springé«˜çº§å®¹å™¨ä¸­æœ€é‡è¦çš„ç±»</li> <li>ç»§æ‰¿äº†DefaultResourceLoader</li> <li>äº‹ä»¶å‘é€å¹¿æ’­ã€ç›‘å¬å™¨æ³¨å†Œã€getBeanæ–¹æ³•å®ç°ã€refresh</li></ul></li></ul> <h3 id="_1-4-resourceã€resourceloader"><a href="#_1-4-resourceã€resourceloader" class="header-anchor">#</a> 1.4. Resourceã€ResourceLoader</h3> <img src="/assets/img/spring/image-20220425201249587.png" alt="image-20220425201249587" style="zoom:50%;"> <ul><li><p><code>EncodedResource</code></p> <ul><li>å®ç°å¯¹èµ„æºæ–‡ä»¶çš„ç¼–ç å¤„ç†</li> <li>getReader</li></ul></li> <li><p><code>AbstractResource</code></p></li> <li><p><code>ServletContextResource</code></p></li> <li><p><code>ClassPathResource</code></p> <ul><li>åˆ©ç”¨ç›¸å¯¹è·¯å¾„çš„æ–¹å¼è®¿é—®WEB-INF/classesç±»è·¯å¾„ä¸‹çš„èµ„æº</li></ul></li> <li><p><code>FileSystemResource</code></p></li> <li><p>Springæä¾›äº†å¼ºå¤§çš„åŠ è½½èµ„æºæ–¹å¼</p> <ul><li>è‡ªåŠ¨è¯†åˆ«â€œclasspath:â€ã€â€œfile:â€ç­‰èµ„æºåœ°å€å‰ç¼€</li> <li>æ”¯æŒè‡ªåŠ¨è§£æAnté£æ ¼å¸¦é€šé…ç¬¦çš„èµ„æºåœ°å€</li></ul></li> <li><p>Ant</p> <ul><li>è·¯å¾„åŒ¹é…è¡¨è¾¾å¼ï¼Œç”¨æ¥å¯¹uriè¿›è¡ŒåŒ¹é…</li> <li>? - ä»»ä½•å•ä¸ªå­—ç¬¦</li> <li>&quot;*&quot; - 0æˆ–è€…ä»»æ„æ•°é‡å­—ç¬¦æˆ–è€…ç›®å½•</li> <li>&quot;**&quot; - 0æˆ–è€…ä»»æ„æ•°é‡ç›®å½•</li></ul></li> <li><p>Springæ ¹æ®ä¼ å…¥çš„åœ°å€ï¼Œè‡ªåŠ¨æ„å»ºå‡ºé€‚é…äºè¯¥èµ„æºçš„Resourceå®ç°ç±»å®ä¾‹ï¼Œç”¨çš„æ˜¯ResourceLoader</p> <blockquote><p>çœ‹èµ·æ¥åƒæ˜¯ç®€å•å·¥å‚æ¨¡å¼ï¼Œå…¶å®æ˜¯ç­–ç•¥æ¨¡å¼</p> <p>ç®€å•å·¥å‚å¼ºè°ƒçš„æ˜¯è·å–åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ï¼Œç”¨æˆ·å¹¶ä¸äº†è§£å¯¹è±¡çš„æœ¬èº«</p> <p>ç­–ç•¥æ¨¡å¼è¦æ±‚ç”¨æˆ·äº†è§£ç­–ç•¥ï¼Œå³é’ˆå¯¹ä»€ä¹ˆæ ·çš„èµ„æºéœ€è¦ç”¨åˆ°å“ªç§Resourceæ¥åŠ è½½</p></blockquote> <ul><li>getClassLoader</li></ul></li></ul> <img src="/assets/img/spring/image-20220425203123589.png" alt="image-20220425203123589" style="zoom:50%;"> <ul><li><p><code>DefaultResourceLoader</code></p> <ul><li>getResource</li></ul></li> <li><p>ResourceLoaderå¹¶ä¸æ”¯æŒAnté£æ ¼çš„è·¯å¾„è§£æï¼ŒSpringæä¾›äº†ResourcePatternResolveræ¥å£ï¼ŒåŠ å…¥äº†getResourcesæ–¹æ³•ï¼Œè¿”å›å¤šä¸ªResourceå®ä¾‹ï¼Œæ–°å¢äº†ä¸€ç§åè®®å‰ç¼€â€œclasspath*:&quot;</p> <ul><li>PathMatchingResourcePatternResolveræä¾›äº†ResourcePatternResolverå®ç°ï¼Œè¯¥ç±»ç»„åˆäº†ResourceLoaderï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äºç»§æ‰¿è‡ªResourceLoaderçš„æ–¹æ³•çš„å®ç°ä¼šä»£ç†ç»™è¯¥å¼•ç”¨</li></ul></li> <li><p>ApplicationContextç»§æ‰¿äº†ResourcePatternResolveræ¥å£ï¼Œæ‰€ä»¥ä»»ä½•çš„ApplicationContextçš„å®ç°éƒ½å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªResourceLoaderæˆ–è€…ResourcePatternResolverçš„å®ä¾‹</p></li> <li><p>AbstractApplicationContextç»§æ‰¿äº†DefaultResourceLoaderï¼Œå…¶å†…éƒ¨æœ‰ä¸ªgetResourcePatternResolver()æ–¹æ³•ï¼Œè¿”å›äº†PathMathingResourcePatternResolverçš„å®ä¾‹ï¼Œå°†è‡ªå·±ä½œä¸ºResourceLoaderä¼ å…¥ï¼Œè¯¥æ–¹æ³•åœ¨AbstractApplicationContextçš„æ„é€ å‡½æ•°ä¸­å¼•ç”¨</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">protected</span> <span class="token class-name">ResourcePatternResolver</span> <span class="token function">getResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">PathMatchingResourcePatternResolver</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// AbstractApplicationContextæ„é€ å‡½æ•°</span>
<span class="token keyword">public</span> <span class="token class-name">AbstractApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>resourcePatternResolver <span class="token operator">=</span> <span class="token function">getResourcePatternResolver</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="_1-5-beandefinitionreader"><a href="#_1-5-beandefinitionreader" class="header-anchor">#</a> 1.5 BeanDefinitionReader</h3> <blockquote><p>BeanDefinitionReaderåˆ©ç”¨ResourceLoaderæˆ–è€…ResourcePatternResolverå°†é…ç½®ä¿¡æ¯è§£ææˆä¸€ä¸ªä¸€ä¸ªçš„BeanDefinition</p> <p>æœ€ç»ˆå€ŸåŠ©BeanDefinitionRegistryå°†BeanDefinitionæ³¨å†Œåˆ°å®¹å™¨ä¸­</p></blockquote> <img src="/assets/img/spring/image-20220425213903721.png" alt="image-20220425213903721" style="zoom:50%;"> <ul><li>getRegistry() - å°†BeanDefinitionæ³¨å†Œåˆ°BeanDefinitionçš„æ³¨å†Œè¡¨ä¸­ã€beanDefinitionMapã€‘</li> <li>getBeanNameGenerator() - Beanåå­—ç”Ÿæˆå™¨ï¼Œä¸ºåŒ¿åbeanç”Ÿæˆä¸€ä¸ªname</li></ul> <img src="/assets/img/spring/image-20220425214110111.png" alt="image-20220425214110111" style="zoom:50%;"> <ul><li><p><code>AbstractBeanDefinitionReader</code></p> <ul><li>loadBeanDefinitions()æ–¹æ³•æ ¹æ®ç”¨æˆ·æä¾›çš„ResourceLoaderç±»å‹ï¼Œåˆ¤æ–­åŠ è½½ä¸€ä¸ªè¿˜æ˜¯å¤šä¸ªèµ„æº</li></ul></li> <li><p><code>XmlBeanDefinitionReader</code></p></li></ul> <h3 id="_1-6-beandefinitionregistry"><a href="#_1-6-beandefinitionregistry" class="header-anchor">#</a> 1.6 BeanDefinitionRegistry</h3> <img src="/assets/img/spring/image-20220425222146387.png" alt="image-20220425222146387" style="zoom:50%;"> <h3 id="_1-7-beandefinitionæ³¨å†Œæµç¨‹"><a href="#_1-7-beandefinitionæ³¨å†Œæµç¨‹" class="header-anchor">#</a> 1.7 BeanDefinitionæ³¨å†Œæµç¨‹</h3> <ul><li><p>alreadyCreated - ä¸€ä¸ªåå­—åˆ—è¡¨ï¼Œä¿å­˜äº†è‡³å°‘åˆ›å»ºè¿‡ä¸€æ¬¡çš„beançš„åå­—é›†åˆï¼Œå¦‚æœè¿™ä¸ªé›†åˆä¸ä¸ºç©ºï¼Œèµ°ä¸‹é¢é€»è¾‘</p> <ul><li>é”ä½beanDefinitionMap</li> <li>å°†æ–°å¢çš„BeanDefinitionæ”¾è¿›beanDefinitionMap</li> <li>æ–°å»ºä¸€ä¸ªlistï¼Œå°†ä¹‹å‰æ‰€æœ‰BeanDefinitionçš„nameåŠ è¿›å»</li> <li>å°†æ–°å¢çš„BeanDefinitionçš„åå­—åŠ å…¥è¿™ä¸ªlist</li> <li>ç”¨è¿™ä¸ªlistè¦†ç›–ä¹‹å‰çš„beanDefinitionNames</li> <li>ã€æ‰€ä»¥ï¼ŒBeanDefinitionNamesæ˜¯æŒ‰ç…§æ³¨å†Œä¿å­˜è¿›å»çš„ã€‘</li> <li>å¯¹å·²ç»æ³¨å†Œçš„å•ä¾‹beançš„åå­—åˆ—è¡¨ã€manualSingletonNamesã€‘è¿›è¡Œæ›´æ–°ï¼Œå¦‚æœè¦æ–°å¢çš„BeanDefinitionçš„åå­—åœ¨è¿™ä¸ªåˆ—è¡¨é‡Œå°±åˆ æ‰</li></ul></li> <li><p>alreadyCreatedä¸ºç©ºï¼Œè¯´æ˜å®¹å™¨æ˜¯æ–°åˆ›å»ºçš„ï¼Œå¤§èƒ†æ³¨å†Œï¼Œä»manualSingletonNamesä¸­åˆ é™¤è¿™ä¸ªåå­—</p> <p>ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¥½ä¹±ï¼ï¼ï¼ï¼ï¼ï¼</p></li></ul> <h3 id="_1-8-xmlé…ç½®æ–‡ä»¶åŠ è½½beandefinitionæµç¨‹"><a href="#_1-8-xmlé…ç½®æ–‡ä»¶åŠ è½½beandefinitionæµç¨‹" class="header-anchor">#</a> 1.8 xmlé…ç½®æ–‡ä»¶åŠ è½½BeanDefinitionæµç¨‹</h3> <blockquote><p>BeanDefinitionReaderå°†DefaultListableBeanFactoryã€BeanDefinitionRegistryã€‘å’ŒFileSystemXmlApplicationContextã€ResourceLoaderã€‘ä¸²è”åˆ°ä¸€èµ·</p> <p>æ‰€ä»¥ï¼ŒBeanDefinitionReaderçš„å­ç±»å®ç°ï¼Œç»„åˆäº†ResourceLoader</p></blockquote> <img src="/assets/img/spring/image-20220426145447103.png" alt="image-20220426145447103" style="zoom:50%;"> <div class="language-mermaid extra-class"><pre class="language-mermaid"><code><span class="token keyword">sequenceDiagram</span>
	FileSystemXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractApplicationContext<span class="token operator">:</span> è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ï¼Œåˆ›å»ºé»˜è®¤&lt;br/&gt;ResourceLoaderã€PathMatchingResourcePatternResolverã€‘
	FileSystemXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractRefreshableConfigApplicationContext<span class="token operator">:</span> è®¾ç½®èµ„æºè·¯å¾„ã€configLocationsã€‘
	FileSystemXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractApplicationContext<span class="token operator">:</span> è°ƒç”¨refresh<span class="token punctuation">(</span><span class="token punctuation">)</span>æ–¹æ³•
	AbstractApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractApplicationContext<span class="token operator">:</span> è°ƒç”¨obtainFreshBeanFactory<span class="token punctuation">(</span><span class="token punctuation">)</span>æ–¹æ³•
AbstractApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractRefreshableApplicationContext<span class="token operator">:</span> è°ƒç”¨å­ç±»refreshBeanFactoryï¼ˆï¼‰æ–¹æ³•
AbstractRefreshableApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractRefreshableApplicationContext<span class="token operator">:</span> åˆ›å»ºDefaultListableBeanFactory
AbstractRefreshableApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractXmlApplicationContext<span class="token operator">:</span> è°ƒç”¨loadBeanDefinitions<span class="token text string">(beanFactory)</span>
AbstractXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractXmlApplicationContext<span class="token operator">:</span> åˆ›å»ºXmlBeanDefinitionReader&lt;br/&gt;ã€å°†beanFactoryå½“åšBeanDefinitionRegistryä¼ ç»™XmlBeanDefinitionReaderã€‘
AbstractXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractXmlApplicationContext<span class="token operator">:</span> ä¸ºbeanDefinitionReaderè®¾ç½®ResourceLoader&lt;br/&gt;ã€å‚æ•°ä¸ºthisï¼Œä¹Ÿå°±æ˜¯FileSystemXmlApplicationContextã€‘
AbstractXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> AbstractXmlApplicationContext<span class="token operator">:</span> è°ƒç”¨loadBeanDefinitions<span class="token text string">(beanDefinitionReader)</span>æ–¹æ³•
AbstractXmlApplicationContext <span class="token arrow operator">-&gt;&gt;</span> XmlBeanDefinitionReader<span class="token operator">:</span> è°ƒç”¨readerçš„loadBeanDefinitions<span class="token text string">(configLocations)</span>æ–¹æ³•&lt;br/&gt;è‡³æ­¤ï¼Œè¿›å…¥BeanDefinitionReaderçš„æµç¨‹ 
</code></pre></div><h3 id="_1-9-æ³¨è§£é…ç½®åŠ è½½beandefinitionæµç¨‹"><a href="#_1-9-æ³¨è§£é…ç½®åŠ è½½beandefinitionæµç¨‹" class="header-anchor">#</a> 1.9 æ³¨è§£é…ç½®åŠ è½½BeanDefinitionæµç¨‹</h3> <ul><li>DefaultListableBeanFactoryåœ¨è°ƒç”¨å®¹å™¨æ„é€ å‡½æ•°çš„æ—¶å€™ç”Ÿæˆçš„ï¼Œè€Œåœ¨xmlä¸­ï¼Œæ˜¯åœ¨refreshæ–¹æ³•ä¸­çš„obtainFreshBeanFactory()æ–¹æ³•ä¸­åˆ›å»ºçš„ï¼Œæå‰åˆ›å»ºçš„åŸå› æ˜¯éœ€è¦æå‰åˆ›å»ºå‡ºä¸€äº›ç³»ç»Ÿå†…ç½®çš„BeanDefinitionå®ä¾‹</li> <li>æ„é€ å‡½æ•°ä¸­ç›´æ¥åˆ›å»ºAnnotatedBeanDefinitionReaderï¼Œå¹¶å°†è‡ªå·±ä½œä¸ºBeanDefinitionRegistryä¼ å…¥ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒAnnotationConfigApplicationContextç»§æ‰¿äº†GenericApplicationContextï¼ŒGenericApplicationContextåˆå®ç°äº†BeanDefinitionRegistryæ¥å£ï¼Œä½†æ˜¯çœŸæ­£æ³¨å†ŒBeanDefinitionçš„æ˜¯GenericApplicationContextä¸­çš„æˆå‘˜å˜é‡DefaultListableBeanFactory</li> <li>AnnotatedBeanDefinitionReaderå¹¶ä¸å±äºBeanDefinitionReaderçš„ä½“ç³»ï¼Œè€Œæ˜¯ä¸“é—¨è´Ÿè´£æ³¨è§£ç›¸å…³çš„BeanDefinitionçš„æ³¨å…¥</li> <li>å…¥å£ç±»çš„Beanæ³¨å†Œå’Œæ™®é€šBeanæ³¨å†Œçš„æµç¨‹ä¸ä¸€æ ·ï¼Œå…¥å£ç±»ä¸ç³»ç»Ÿå†…ç½®çš„Beanä¸€æ ·ï¼Œåœ¨æ„é€ æ–¹æ³•ä¸­å°±å·²ç»ç”Ÿæˆäº†ï¼Œè€Œæ™®é€šbeanï¼Œæ˜¯åœ¨refresh()æ–¹æ³•ä¸­çš„invokeBeanFactoryPostProcessors(beanFactory)æ–¹æ³•ä¸­æ‰§è¡Œçš„</li></ul> <p>å¾…è¡¥å……ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p> <h2 id="_2-refresh-æ–¹æ³•"><a href="#_2-refresh-æ–¹æ³•" class="header-anchor">#</a> 2. Refresh()æ–¹æ³•</h2> <h3 id="_2-1-postprocessor"><a href="#_2-1-postprocessor" class="header-anchor">#</a> 2.1 PostProcessor</h3> <blockquote><p>ä¹Ÿæ˜¯æ³¨å†Œåˆ°Springé‡Œçš„bean</p> <p>é‡Œé¢çš„æ–¹æ³•ä¼šåœ¨ç‰¹å®šæ—¶æœºè¢«è°ƒç”¨</p> <p>å®ç°ä¸æ”¹å˜å®¹å™¨æˆ–è€…Beanæ ¸å¿ƒé€»è¾‘çš„æƒ…å†µä¸‹å¯¹Beanè¿›è¡Œæ‰©å±•</p></blockquote> <ul><li>BeanDefinitionRegistryPostProcessor</li> <li>BeanFactoryPostProcessor</li> <li>BeanPostProcessor</li></ul> <h3 id="_2-2-awareæ¥å£"><a href="#_2-2-awareæ¥å£" class="header-anchor">#</a> 2.2 Awareæ¥å£</h3> <blockquote><p>ä»beané‡Œè·å–åˆ°çš„å®¹å™¨å®ä¾‹å¹¶å¯¹å…¶è¿›è¡Œæ“ä½œ</p></blockquote> <p><img src="/assets/img/spring/image-20220426170847965.png" alt="image-20220426170847965"></p> <h3 id="_2-3-äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼"><a href="#_2-3-äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼" class="header-anchor">#</a> 2.3 äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼</h3> <img src="/assets/img/spring/image-20220426173005122.png" alt="image-20220426173005122" style="zoom:50%;"> <p><strong>äº‹ä»¶é©±åŠ¨æ¨¡å‹çš„ä¸‰å¤§ç»„æˆéƒ¨åˆ†</strong></p> <ol><li>äº‹ä»¶ï¼šApplicationEvent
<ol><li>PayloadApplicationEvent&lt;T&gt; - åœ¨å®¹å™¨å†…ä¸å‘å¸ƒä»»æ„äº‹ä»¶çš„æ—¶å€™ï¼Œå®¹å™¨éƒ½ä¼šè‡ªåŠ¨åŒ…è£…æˆPayloadApplicationEventç±»å‹</li></ol></li> <li>äº‹ä»¶ç›‘å¬å™¨ï¼šApplicationListener
1.</li> <li>äº‹ä»¶å‘å¸ƒå™¨ï¼šApplicationEventPublisherã€ApplicationEventMulticaster</li></ol> <h3 id="_2-4-refresh-æ–¹æ³•æµç¨‹"><a href="#_2-4-refresh-æ–¹æ³•æµç¨‹" class="header-anchor">#</a> 2.4 refresh()æ–¹æ³•æµç¨‹</h3> <h4 id="_2-4-1"><a href="#_2-4-1" class="header-anchor">#</a> 2.4.1</h4> <p>jvm</p> <p>thread</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æ›´æ–°æ—¶é—´:</span> <span class="time">4/28/2022, 5:30:38 PM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.5a0d12c5.js" defer></script><script src="/docs/assets/js/2.e7fbde6b.js" defer></script><script src="/docs/assets/js/9.499b8aef.js" defer></script>
  </body>
</html>
